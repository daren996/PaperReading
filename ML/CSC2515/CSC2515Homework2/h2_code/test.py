import matplotlib.pyplot as plt
import numpy as np

train_losses = {10.0: 1.4916490077551599e+23, 10.234114021054532: 2.776511800164412e+18,
                10.473708979594498: 20956078709632.445, 10.718913192051275: 4642354764605363.0,
                10.969857978923836: 2.886515772171602e+22, 11.226677735108137: 3019623119296.1206,
                11.489510001873091: 3.169568631420786e+25, 11.758495540521569: 7.723825668202968e+16,
                12.033778407775893: 2.3539235348691576e+16, 12.315506032928255: 1.9209174207140016e+16,
                12.603829296797274: 1.8019159631581227e+20, 12.898902612533087: 428847516787800.44,
                13.200884008314182: 6.775228423421917e+25, 13.509935211980265: 168883673889947.56,
                13.826221737646557: 1.1724349813429014e+21, 14.149912974345758: 1.2742820116174431e+24,
                14.481182276745338: 1.2642375638609372e+24, 14.820207057988586: 7.454485503042535e+25,
                15.167168884709225: 1.148116980661988e+18, 15.522253574270472: 430099520337421.3,
                15.885651294280526: 3.943378422583562e+23, 16.257556664437942: 2.5590520504995104e+17,
                16.63816886076129: 5316455455664548.0, 17.027691722258997: 4.416033391369858e+23,
                17.4263338600965: 1.5308595931116172e+25, 17.834308769319094: 1372536760631049.5,
                18.251834943190435: 6.042459191180533e+25, 18.67913599020783: 6.197469392133164e+22,
                19.116440753857017: 1.5524151309349335e+23, 19.563983435170638: 3.395616269564598e+21,
                20.022003718155844: 1.1998234482943101e+24, 20.49074689815847: 1.058980869491469e+25,
                20.970464013232327: 9.502704835973498e+23, 21.461411978584035: 3.90053733315944e+25,
                21.963853724165457: 4.845440149829513e+17, 22.47805833548725: 8.717590966525125e+25,
                23.00430119772918: 5.756679305000052e+18, 23.54286414322418: 2007616274483431.2,
                24.094035602395245: 3.5034330718438254e+20, 24.658110758226037: 2.1476061120291013e+25,
                25.23539170434766: 7.14800532301394e+17, 25.82618760682676: 1044377514524277.9,
                26.430814869741056: 5.318722793459669e+24, 27.049597304631344: 39314.20597091427,
                27.682866303920665: 12008341407.757912, 28.330961018393243: 9.492267806294872e+22,
                28.994228538828768: 227848.7010194649, 29.673024081888695: 3719.542985807854,
                30.367711180354576: 6.933167200794641e+25, 31.07866187782014: 254.0890302249458,
                31.80625692794119: 10103.181354410934, 32.55088599835058: 6438.2026241159965,
                33.31294787934674: 827.901382958908, 34.09285069746811: 245.30708628343257,
                34.891012134067736: 2.631370616796548e+27, 35.707859649004625: 1135.1305983044701,
                36.54383070957256: 2433.6216075153475, 37.39937302478798: 6.532469838795083e+22,
                38.274944785163115: 17.78863516289709, 39.17101490809261: 33.859109382308674,
                40.08806328898464: 1.7222884364703742e+23, 41.02658105827192: 3.5335570049196215e+24,
                41.9870708444391: 301698305.63167137, 42.970047043208396: 4.037969270560589e+23,
                43.97603609302721: 3894483877.7042947, 45.005576757004974: 123.16845144114511,
                46.05922041145106: 6491318461.185961, 47.13753134116724: 218868046601841.44,
                48.241087041653685: 23.206607366272046, 49.37047852839004: 10.637847487667075,
                50.526310653356795: 6.320231361042499, 51.70920242896758: 6.154042207208163,
                52.91978735958442: 6.128783871964778, 54.158713780794706: 6.19723568208184,
                55.42664520663107: 6.264119491543776, 56.72426068491978: 6.327589579062809,
                58.05225516094899: 6.390325996890885, 59.41133984965034: 6.451835925469439,
                60.80224261649424: 6.5122802510469215, 62.22570836730231: 6.571797577826111,
                63.68249944718586: 6.630590525332893, 65.17339604882423: 6.689022213250489,
                66.69919663030122: 6.747590466615385, 68.26071834272389: 6.80683806795616,
                69.8587974678525: 6.867192633376948, 71.49428986597577: 6.928818157062506,
                73.16807143427197: 6.991557181838353, 74.88103857590023: 7.054988812883919,
                76.63410868007459: 7.118557563883218, 78.42822061337682: 7.181703636808304,
                80.26433522257175: 7.243948956171288, 82.14343584919426: 7.3049324910230045,
                84.06652885618325: 7.36441505672805, 86.03464416684504: 7.422280551681112,
                88.04883581643465: 7.4785508889157155, 90.11018251665018: 7.533411104563406,
                92.21978823334327: 7.587218438646333, 94.37878277775381: 7.640461430566978,
                96.58832241158703: 7.69365714024833, 98.84959046625586: 7.747218082427593,
                101.1637979766207: 7.801349883965632, 103.53218432956616: 7.856027363297604,
                105.9560179277616: 7.911051837032599, 108.43659686896109: 7.966153134303311,
                110.97524964120721: 8.021090128172748, 113.57333583431051: 8.075719615660532,
                116.23224686798518: 8.130026780340357, 118.95340673703195: 8.184126280767632,
                121.7382727739662: 8.23824727270066, 124.58833642950081: 8.292712690896172,
                127.50512407130128: 8.347918331281367, 130.49019780144016: 8.40431335052583,
                133.54515629298987: 8.462381394127172, 136.67163564620074: 8.522620803722932,
                139.87131026472386: 8.585522966587172, 143.14589375234786: 8.651549158342155,
                146.49713983072849: 8.72110749993103, 149.92684327860457: 8.794532489001929,
                153.43684089300132: 8.872069777221697, 157.02901247293775: 8.953868365772884,
                160.70528182616385: 9.039981243450889, 164.46761779946627: 9.13037396594919,
                168.31803533309568: 9.22493921336554, 172.25859653987874: 9.323514417305583,
                176.2914118095948: 9.425899381759274, 180.41864093920717: 9.53187139992737,
                184.64249428955426: 9.641196408232865, 188.96523396912096: 9.753635838203843,
                193.38917504552322: 9.86894971499647, 197.91668678535575: 9.98689705514802,
                202.55019392306664: 10.107234741517928, 207.29217795953699: 10.229715905512716,
                212.14517849106298: 10.35408855884961, 217.11179456945052: 10.480094903245142,
                222.19468609395238: 10.607471477398708, 227.39657523579274: 10.735950107991389,
                232.72024789604072: 10.865259516933996, 238.16855519761583: 10.995127387368056,
                243.74441501222216: 11.125282686372076, 249.45081352303166: 11.255458065199827,
                255.29080682395167: 11.385392193334365, 261.26752255633266: 11.514831921376727,
                267.3841615839947: 11.643534203199321, 273.6439997074672: 11.771267737880953,
                280.0503894183631: 11.897814315175372, 286.606761694825: 12.022969865326488,
                293.31662783900424: 12.146545225862466, 300.1835813575589: 12.26836664553205,
                307.21129988617594: 12.388276049839787, 314.40354715915: 12.506131094867824,
                321.76417502507354: 12.621805036387016, 329.29712550971516: 12.735186440901204,
                337.0064329271928: 12.846178763862664, 344.896226040576: 12.954699818896529,
                352.970730273065: 13.060681159716582, 361.23426997094305: 13.164067394750063,
                369.6912707195028: 13.264815452206959, 378.3462617131929: 13.36289381154312,
                387.20387818125573: 13.458281715203881, 396.2688638701478: 13.550968372720922,
                405.54607358408276: 13.640952167548791, 415.04047578504765: 13.72823987527781,
                424.75715525368986: 13.812845900508284, 434.7013158125026: 13.894791538130207,
                444.87828311275854: 13.97410426370399, 455.29350748669475: 14.05081705637196,
                465.9525668664682: 14.124967756886075, 476.86116977144695: 14.196598462368936,
                488.02515836544336: 14.265754958863623, 499.450511585514: 14.33248619188047,
                511.14334834401654: 14.396843774912764, 523.1099308056264: 14.458881535187766,
                535.3566677410724: 14.518655095792047, 547.8901179593945: 14.576221492905983,
                560.7169938205458: 14.631638826766627, 573.8441648302393: 14.684965944746603,
                587.2786613189483: 14.736262154919691, 601.0276782070382: 14.785586968292522,
                615.0985788580505: 14.832999868041233, 629.4988990221888: 14.878560103892644,
                644.236350872137: 14.92232650993263, 659.3188271333548: 14.964357344142329,
                674.7544053110693: 15.004710147975343, 690.5513520162331: 15.043441624389036,
                706.7181273927491: 15.080607532818307, 723.2633896483534: 15.116262599625758,
                740.1959996915645: 15.1504604426454, 757.5250258771913: 15.183253508573003,
                775.2597488629465: 15.21469302196538, 793.4096665797492: 15.244828944712717,
                811.9844993184009: 15.273709944950895, 830.9941949353396: 15.301383374461167,
                850.4489341802678: 15.327895253620877, 870.3591361485165: 15.353290263082773,
                890.735463861044: 15.377611741459527, 911.5888299750818: 15.400901688270961,
                932.9304026284686: 15.423200771524769, 954.7716114208066: 15.444548339378846,
                977.1241535346502: 15.46498243531024, 1000.0: 15.48453981633028}
test_losses = {10.0: 1.9143299412249536e+18, 10.234114021054532: 1.7503440261485476e+16,
               10.473708979594498: 1.3720426149775496e+16, 10.718913192051275: 41386167879045.94,
               10.969857978923836: 15771841258018.277, 11.226677735108137: 1484344992.0429516,
               11.489510001873091: 1734568184145.8567, 11.758495540521569: 403284329229874.94,
               12.033778407775893: 8.353596408419394e+25, 12.315506032928255: 2.181700954718026e+22,
               12.603829296797274: 223823704878597.38, 12.898902612533087: 1381.41576769509,
               13.200884008314182: 1.7537134573366952e+16, 13.509935211980265: 7.499628153187718e+17,
               13.826221737646557: 5562.596607252442, 14.149912974345758: 11335.683721842926,
               14.481182276745338: 3.2676988346230907e+19, 14.820207057988586: 6.200791285869347e+27,
               15.167168884709225: 6500.659185365418, 15.522253574270472: 1.454888765614831e+21,
               15.885651294280526: 5.449973612253151e+25, 16.257556664437942: 3141307197475709.0,
               16.63816886076129: 2184917082134940.8, 17.027691722258997: 2.0170193344895015e+26,
               17.4263338600965: 3.902413778714165e+17, 17.834308769319094: 2002980561240290.0,
               18.251834943190435: 3868.580955081906, 18.67913599020783: 22312.560032506368,
               19.116440753857017: 3.392089937147129e+17, 19.563983435170638: 249442.17964760715,
               20.022003718155844: 8335.159466651565, 20.49074689815847: 14367258344808.38,
               20.970464013232327: 7.03475095314029e+18, 21.461411978584035: 9.659584304981038e+24,
               21.963853724165457: 2.0130366037777324e+18, 22.47805833548725: 2.526253557219632e+26,
               23.00430119772918: 17186.48886979512, 23.54286414322418: 4908903937881124.0,
               24.094035602395245: 7.142421786825072e+31, 24.658110758226037: 2.0427868508234113e+19,
               25.23539170434766: 1236381823452003.2, 25.82618760682676: 2506.7104203067674,
               26.430814869741056: 9895.339494379867, 27.049597304631344: 35941.421616491105,
               27.682866303920665: 1232.8853834076936, 28.330961018393243: 2055.9145338222243,
               28.994228538828768: 22384.380283994436, 29.673024081888695: 771.1835249694459,
               30.367711180354576: 52.8345880283441, 31.07866187782014: 440.7403114613167,
               31.80625692794119: 27775.1743889908, 32.55088599835058: 180.12763692183148,
               33.31294787934674: 295.7920813674192, 34.09285069746811: 119.37939112940302,
               34.891012134067736: 3.4029066402739114e+25, 35.707859649004625: 907.7695537238025,
               36.54383070957256: 165.50637276174746, 37.39937302478798: 987.0925679580715,
               38.274944785163115: 243771.6510127967, 39.17101490809261: 110402.21396545006,
               40.08806328898464: 32.416604039631586, 41.02658105827192: 2117.0916372746638,
               41.9870708444391: 819061.9823678042, 42.970047043208396: 240069929520.41885,
               43.97603609302721: 254329806853.3382, 45.005576757004974: 556.6404946569511,
               46.05922041145106: 40.0048114400008, 47.13753134116724: 29.482711766918772,
               48.241087041653685: 54616625622.79667, 49.37047852839004: 28.344478781538783,
               50.526310653356795: 33.42639516781717, 51.70920242896758: 28.309909373221227,
               52.91978735958442: 28.308164245185164, 54.158713780794706: 28.3120788644777,
               55.42664520663107: 28.315368204454415, 56.72426068491978: 28.317304711681317,
               58.05225516094899: 28.318917881778997, 59.41133984965034: 28.31922267213824,
               60.80224261649424: 28.31753713015833, 62.22570836730231: 28.313004178143,
               63.68249944718586: 28.30478369136524, 65.17339604882423: 28.29225704544237,
               66.69919663030122: 28.275137483782327, 68.26071834272389: 28.253487489115354,
               69.8587974678525: 28.227594832218085, 71.49428986597577: 28.197759861156353,
               73.16807143427197: 28.164084033194808, 74.88103857590023: 28.126334505448533,
               76.63410868007459: 28.083904049964783, 78.42822061337682: 28.03584208340469,
               80.26433522257175: 27.980926451901695, 82.14343584919426: 27.91776419161298,
               84.06652885618325: 27.844930273819, 86.03464416684504: 27.76115938310836,
               88.04883581643465: 27.665587982828733, 90.11018251665018: 27.55800532958091,
               92.21978823334327: 27.439032043155986, 94.37878277775381: 27.31013919921137,
               96.58832241158703: 27.173476376293706, 98.84959046625586: 27.031570813293683,
               101.1637979766207: 26.887021077706876, 103.53218432956616: 26.742288124720563,
               105.9560179277616: 26.599611588102896, 108.43659686896109: 26.461016360436954,
               110.97524964120721: 26.328357837336167, 113.57333583431051: 26.203369534674724,
               116.23224686798518: 26.087697074098294, 118.95340673703195: 25.982914553022216,
               121.7382727739662: 25.89052398952788, 124.58833642950081: 25.811940676363506,
               127.50512407130128: 25.74846903298611, 130.49019780144016: 25.701274243234735,
               133.54515629298987: 25.671353983295962, 136.67163564620074: 25.65951272062274,
               139.87131026472386: 25.666339680009504, 143.14589375234786: 25.69219118970507,
               146.49713983072849: 25.737178567696706, 149.92684327860457: 25.801163469491485,
               153.43684089300132: 25.883763054947188, 157.02901247293775: 25.984366882665803,
               160.70528182616385: 26.102165910561833, 164.46761779946627: 26.23619173765302,
               168.31803533309568: 26.385362065116777, 172.25859653987874: 26.548527114484223,
               176.2914118095948: 26.724511850527172, 180.41864093920717: 26.912150175450837,
               184.64249428955426: 27.11030922606287, 188.96523396912096: 27.317903849078704,
               193.38917504552322: 27.533902765081717, 197.91668678535575: 27.75732867026885,
               202.55019392306664: 27.98725463124955, 207.29217795953699: 28.222798806281983,
               212.14517849106298: 28.46311899913337, 217.11179456945052: 28.70740799698607,
               222.19468609395238: 28.95489016638725, 227.39657523579274: 29.20481942691774,
               232.72024789604072: 29.45647849047171, 238.16855519761583: 29.709179128034076,
               243.74441501222216: 29.962263175576087, 249.45081352303166: 30.21510399229808,
               255.29080682395167: 30.46710811539319, 261.26752255633266: 30.717716901118585,
               267.3841615839947: 30.966407991693053, 273.6439997074672: 31.212696495279936,
               280.0503894183631: 31.456135808318646, 286.606761694825: 31.696318044958513,
               293.31662783900424: 31.932874066088925, 300.1835813575589: 32.16547312200387,
               307.21129988617594: 32.393822137590206, 314.40354715915: 32.61766467922522,
               321.76417502507354: 32.836779648065054, 329.29712550971516: 33.05097974734235,
               337.0064329271928: 33.2601097707099, 344.896226040576: 33.464044757096644,
               352.970730273065: 33.66268805420232, 361.23426997094305: 33.85596932865017,
               369.6912707195028: 34.043842556439664, 378.3462617131929: 34.22628402250854,
               387.20387818125573: 34.40329035386695, 396.2688638701478: 34.57487660602647,
               405.54607358408276: 34.741074418828745, 415.04047578504765: 34.9019302535052,
               424.75715525368986: 35.05750372019757, 434.7013158125026: 35.20786600167778,
               444.87828311275854: 35.35309837694625, 455.29350748669475: 35.493290846273744,
               465.9525668664682: 35.62854085732471, 476.86116977144695: 35.75895213100169,
               488.02515836544336: 35.8846335841734, 499.450511585514: 36.00569834586941,
               511.14334834401654: 36.12226286291728, 523.1099308056264: 36.234446090267056,
               535.3566677410724: 36.342368761408224, 547.8901179593945: 36.44615273374677,
               560.7169938205458: 36.54592040406971, 573.8441648302393: 36.64179418889661,
               587.2786613189483: 36.73389606514842, 601.0276782070382: 36.822347166075765,
               615.0985788580505: 36.907267428160615, 629.4988990221888: 36.988775284522085,
               644.236350872137: 37.0669874007793, 659.3188271333548: 37.14201844953017,
               674.7544053110693: 37.21398091974544, 690.5513520162331: 37.28298495784087,
               706.7181273927491: 37.34913823718994, 723.2633896483534: 37.41254585321513,
               740.1959996915645: 37.47331024144401, 757.5250258771913: 37.531531115933525,
               775.2597488629465: 37.58730542600575, 793.4096665797492: 37.64072732900878,
               811.9844993184009: 37.69188817741774, 830.9941949353396: 37.74087651845018,
               850.4489341802678: 37.78777810466863, 870.3591361485165: 37.832675914170224,
               890.735463861044: 37.87565017907875, 911.5888299750818: 37.916778421134545,
               932.9304026284686: 37.9561354934727, 954.7716114208066: 37.993793627496956,
               977.1241535346502: 38.02982248413756, 1000.0: 38.06428920865892}

threshold = 300

plt.semilogx([tl for tl in train_losses if train_losses[tl] < threshold],
             [train_losses[tl] for tl in train_losses if train_losses[tl] < threshold], label="train_loss")
plt.semilogx([tl for tl in test_losses if test_losses[tl] < threshold],
             [test_losses[tl] for tl in test_losses if test_losses[tl] < threshold], label="validation_loss")
plt.legend()
# plt.show()



